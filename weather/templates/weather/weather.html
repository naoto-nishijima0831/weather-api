{% if user.is_authenticated %}
    <p>{{ user.get_username }}でログイン中</p>
{% endif %}

<p><a href="{% url 'accounts:logout' %}">ログアウト</a></p>

<form action="{% url 'weather:api'%}" method="post">
    {% csrf_token %}
    <div>
        <label for="from-date">開始日:</label>
        <input type="date" name="from-date" id="from-date" />
    </div>
    <div>
        <label for="to-date">終了日:</label>
        <input type="date" name="to-date" id="to-date" />
    </div>
    <div>
        <label for="area">エリア:</label>
        <select name="area">
            <option value="Tokyo">東京</option>
            <option value="Yokohama">横浜</option>
        </select>
    </div>
    <div>
        <label for="target">集計対象:</label>
        <select name="target">
            <option value="precipitation">降水量</option>
            <option value="daylight">日照時間</option>
            <option value="windspeed">風速</option>
        </select>
    </div>
    <div>
        <label for="period">期間種別:</label>
        <select name="period">
            <option value="daily">日別</option>
            <option value="weekly">週別</option>
            <option value="monthly">月別</option>
        </select>
    </div>
    <div>
        <button type="submit">更新</button>
    </div>
    <div>
        <table>
            <tr>
                <th>開始日</th>
                <th>終了日</th>
                <th>エリア</th>
                <th>集計対象</th>
                <th>最小値</th>
                <th>最大値</th>
                <th>平均値</th>
            </tr>
            {% for record in api_result %}
                <tr>
                    <td>{{ record.from_date }}</td>
                    <td>{{ record.to_date }}</td>
                    <td>{{ record.area }}</td>
                    <td>{{ record.target }}</td>
                    <td>{{ record.value.min }}</td>
                    <td>{{ record.value.max }}</td>
                    <td>{{ record.value.average }}</td>
                </tr>
            {% endfor %}
        </table>
    </div>
</form>